"use strict";var urlForApi="/api/url",Game=function(e){var t={apiUrl:e,id:0,aanDeBeurt:"geen",kleur:"wit"},a=function(){Game.Data.get("api/Spel/IsBezig/".concat(t.id)).then(function(e){e?(Game.Data.get("api/Spel/Speelbord/".concat(t.id)).then(function(e){$(".game").html(Game.Template.parseTemplates("speelbord.speelbord",{bord:e})),Game.Data.telFishies(e)}),Game.Data.get("api/Spel/AanDeBeurt/".concat(t.id)).then(function(e){t.aanDeBeurt=e,Game.Stats.init(),1===e?(t.aanDeBeurt="wit",$(".aanDeBeurt").html("De kleur wit is aan de beurt!")):2===e&&(t.aanDeBeurt="zwart",$(".aanDeBeurt").html("De kleur zwart is aan de beurt!"))})):location.reload()})};return{init:function(e,n){t.id=e,1===n?t.kleur="wit":2===n&&(t.kleur="zwart"),window.setInterval(a,2e3)},configMap:t}}(urlForApi);Game.API=function(){return{getRandomFact:function(){return Game.Data.get("https://uselessfacts.jsph.pl/random.json")}}}(),Game.Data=function(){var e={mock:[{url:"api/Spel/Speelbord/0",data:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,1,2,0,0,0],[0,0,0,2,1,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{url:"api/Spel/IsBezig/0",data:!0},{url:"api/Spel/AanDeBeurt/0",data:1}]},t={environment:"production"},a=function(t){var a=e.mock.find(function(e){return e.url===t});return new Promise(function(e,t){e(a.data)})},n=function(e){return"development"!==t.environment?(e.startsWith("api")&&(e="https://"+window.location.href.split("/")[2]+"/"+e),$.get(e).then(function(e){return e}).catch(function(e){console.log(e.message)})):a(e)},r=function(e,a){if("development"!==t.environment)return e="https://"+window.location.href.split("/")[2]+"/"+e,$.ajax({url:e,method:"PUT",contentType:"application/json",dataType:"text",data:JSON.stringify(a)})},i=function(){if(null==localStorage.getItem("aantal_fishies")){var e={zwart:[],wit:[]};return localStorage.setItem("aantal_fishies",JSON.stringify(e)),e}return JSON.parse(localStorage.getItem("aantal_fishies"))},o=function(e,t){var a=i();if(console.log("3"),2===e)console.log("4"),a.zwart.push(t);else{if(1!==e)throw new Error("Onjuiste kleur!");console.log("5"),a.wit.push(t)}localStorage.setItem("aantal_fishies",JSON.stringify(a))},l=function(){if(null==localStorage.getItem("beurten")){var e=[0];return localStorage.setItem("beurten",JSON.stringify(e)),e}return JSON.parse(localStorage.getItem("beurten"))},u=function(e){var t=l();t.push(e),localStorage.setItem("beurten",JSON.stringify(t))},s=function(e){var t=0,a=0,n=!0,r=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var m=s.value,f=!0,p=!1,d=void 0;try{for(var g,h=m[Symbol.iterator]();!(f=(g=h.next()).done);f=!0){var w=g.value;1===w?t++:2===w&&a++}}catch(e){p=!0,d=e}finally{try{f||null==h.return||h.return()}finally{if(p)throw d}}}}catch(e){r=!0,u=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw u}}var v=i(),S=v.wit[v.wit.length-1],D=v.zwart[v.zwart.length-1];if(console.log("2"),t!==S||a!==D){console.log("1"),o(2,a),o(1,t);var G=l();if(v.wit.length===G.length){var b=G[G.length-1];Game.Data.setAantalBeurten(b+1)}}};return{init:function(a){if("production"!==a)t.environment=a;else{if("development"===a)throw new Error("environment is niet correct meegegeven!");console.log(e.mock.indexOf(url))}},get:n,put:r,stateMap:t,aantalFishies:i,setAantalFishies:o,setAantalBeurten:u,getAantalBeurten:l,telFishies:s}}(),Game.Model=function(){var e=function(){Game.Data.get(weatherUrl).then(function(e){return console.log(e)})},t=function(){var e=1;if(0!==e&&1!==e&&2!==e)throw new Error("Dit is niet een juiste beurt!");return e},a=function(){console.log("Doing private stuff")};return{init:function(){a()},getWeather:e,_getGameState:t}}();var elementIdVoorSpelbord="spelbord";Game.Reversi=function(e){var t={elementId:e},a=function(e,a){if(Game.configMap.aanDeBeurt===Game.configMap.kleur)if("development"!==Game.Data.stateMap.environment)var r=Game.Data.put("api/Spel/ZetMogelijk/",{id:Game.configMap.id,rij:a,kolom:e}).always(function(){204===r.status?(n(),document.getElementById("spelbord__veld"+e+a).innerHTML="<div class='fishie fadeIn "+t.kleur+"'></div>",Game.Data.get("api/Spel/Speelbord/".concat(Game.configMap.id)).then(function(e){$(".game").html(spa_templates.templates.speelbord.speelbord({bord:e})),Game.Data.telFishies(e)}),Game.Data.get("api/Spel/AanDeBeurt/".concat(Game.configMap.id)).then(function(e){t.aanDeBeurt=e,Game.Stats.init(),1===e?(t.aanDeBeurt="wit",$(".aanDeBeurt").html("De kleur wit is aan de beurt!")):2===e&&(t.aanDeBeurt="zwart",$(".aanDeBeurt").html("De kleur zwart is aan de beurt!"))}),"wit"===t.kleur?t.kleur="zwart":"zwart"===t.kleur&&(t.kleur="wit")):alert("Het is niet mogelijk om op rij "+a+" en kolom "+e+" neer te zetten!")});else document.getElementById("spelbord__veld"+e+a).innerHTML="<div class='fishie fadeIn "+t.kleur+"'></div>","wit"===t.kleur?(Game.Stats.init(),t.kleur="zwart"):"zwart"===t.kleur&&(Game.Stats.init(),t.kleur="wit");else alert("U bent momenteel niet aan de beurt!")},n=function(){Game.API.getRandomFact().then(function(e){$(".randomFact").html(Game.Template.parseTemplates("randomFacts.randomFacts",{language:e.language,fact:e.text}))})};return{showFishie:a,configMap:t,laadRandomFact:n}}(elementIdVoorSpelbord),Game.Stats=function(){var e=function(){var e=Game.Data.aantalFishies(),t=Game.Data.getAantalBeurten();$(".grafiek").html(Game.Template.parseTemplates("chart.chart",{zwart:e.zwart,wit:e.wit,beurten:t}))};return{init:function(){setTimeout(function(){e()},2e3)},updateGraph:e}}(),Game.Template=function(){var e=function(e){var t=e.split("."),a=spa_templates.templates;return t.forEach(function(e){a=a[e]}),a};return{parseTemplates:function(t,a){return e(t)(a)}}}();